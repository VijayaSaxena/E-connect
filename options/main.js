$(document).ready(function(){accounts=store.get("accounts");if(!accounts){accounts=[]}loadAccounts();setInterval(function(){var b=store.get("accounts");if(b){for(var a in b){if(!b[a].image){b.splice(a,1)}}if(accounts.length!=b.length){accounts=b;loadAccounts()}}},3000);$("#version div").text(chrome.extension.getBackgroundPage().twitter.version);$("input").each(function(){if(this.id){this.checked=store.get(this.id)}});$("select").each(function(){this.value=store.get(this.id)});checkGrowl();$("button").live("click",function(){switch(this.id){case"connect":if(accounts.length>0&&!localStorage.donated){$("#donate").fadeIn(250)}else{chrome.extension.getBackgroundPage().twitter.requestToken()}break;case"growlInstallButton":chrome.tabs.create({url:"#"});setInterval(checkGrowl,2000);break;default:var c=this.parentNode.parentNode.parentNode.parentNode;var a=c.id.substr(7);accounts=chrome.extension.getBackgroundPage().accounts;if(this.className=="logout"){if(confirm("Logout of this account?")){try{accounts[a].disabled=true;accounts[a].stream.connection.abort()}catch(d){}accounts.splice(a,1);chrome.extension.getBackgroundPage().updateAccounts();c.parentNode.removeChild(c)}}if(this.className==="disable"){if(accounts[a].disabled){accounts[a].disabled=false;accounts[a].stream.start(accounts[a]);this.innerText="Disable";c.style.opacity="1"}else{accounts[a].disabled=true;accounts[a].stream.connection.abort();this.innerText="Enable";c.style.opacity="0.2"}chrome.extension.getBackgroundPage().updateAccounts()}if(this.className=="default"){for(var b in accounts){if(accounts[b]["default"]){delete accounts[b]["default"]}}accounts[this.parentNode.parentNode.id.substr(7)]["default"]=true;$(".default").removeAttr("disabled");$(".default").text("Make default");this.innerText="Default";this.disabled="disabled";chrome.extension.getBackgroundPage().updateAccounts()}break}});$(".navbar-item").click(function(){$(".navbar-item").removeClass("navbar-item-selected");$(this).addClass("navbar-item-selected");$(".page").hide();$("#"+this.id+"Page").show()});$("input").live("change",function(){if(this.id){store.set(this.id,this.checked)}else{var a=this.parentNode.parentNode.parentNode.parentNode.parentNode.id.substr(7);accounts=chrome.extension.getBackgroundPage().accounts;accounts[a][this.className]=this.checked;chrome.extension.getBackgroundPage().updateAccounts()}});$("select").live("change",function(){localStorage[this.id]=this.value});$(".donateButton").click(function(){localStorage.donated=true;$("#preDonate").fadeOut(250);$("#postDonate").delay(250).fadeIn(250)});$("#postDonateConnect").click(function(){chrome.extension.getBackgroundPage().twitter.requestToken();$("#donate").fadeOut(250)});$("#nodonate").click(function(){$("#donate").fadeOut(250);chrome.extension.getBackgroundPage().twitter.requestToken()})});function loadAccounts(){$("#accountList").html("");for(var a in accounts){if(accounts[a].image){$("#accountTemplate").clone().appendTo("#accountList").attr("id","account"+a).show();$("#account"+a).find("img").attr("src",accounts[a].image.replace("normal","reasonably_small"));$("#account"+a).find("h3").text("@"+accounts[a].screenName);$("#account"+a).find("h1").text(accounts[a].name);if(accounts[a].disabled){$("#account"+a).find(".disable").text("Enable");document.getElementById("account"+a).style.opacity="0.2"}if(accounts[a]["default"]){$("#account"+a).find(".default").text("Default").attr("disabled","disabled")}$("#account"+a).find("input").each(function(){this.checked=accounts[a][this.className]})}else{accounts.splice(a,1)}}if(accounts.length==1){$(".default").text("Default").attr("disabled","disabled")}if(accounts.length==0){$("#accountList").html('<div class="account"><span>No accounts connected</span></div>')}}function checkGrowl(){chrome.extension.sendRequest(chrome.extension.getBackgroundPage().twitter.growlId,{getInstalled:true},function(a){if(a){if(a.isInstalled){$("#growlInstall").hide();$("#growlCheck").show()}}})};
